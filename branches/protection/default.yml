# é»˜è®¤åˆ†æ”¯ä¿æŠ¤è§„åˆ™
# é€‚ç”¨äº feature/*, fix/*, docs/* ç­‰å¼€å‘åˆ†æ”¯
name: default
pattern: "*"  # åŒ¹é…æ‰€æœ‰åˆ†æ”¯

# ä»…å¯¹ç‰¹å®šæ¨¡å¼åº”ç”¨
apply_to:
  - "feature/*"
  - "fix/*"
  - "docs/*"
  - "chore/*"
  - "refactor/*"
  - "test/*"
  - "style/*"
  - "perf/*"

# æ’é™¤çš„åˆ†æ”¯ï¼ˆä¸åº”ç”¨è¿™äº›è§„åˆ™ï¼‰
exclude:
  - main
  - master
  - develop
  - dev
  - staging
  - production
  - "release/*"
  - "hotfix/*"

protection_rules:
  # ==================
  # åŸºç¡€è®¾ç½®ï¼ˆå®½æ¾ï¼‰
  # ==================
  require_pull_request_reviews:
    enabled: false                           # ä¸å¼ºåˆ¶ PR å®¡æ ¸
    
  # ==================
  # çŠ¶æ€æ£€æŸ¥ï¼ˆå¯é€‰ï¼‰
  # ==================
  required_status_checks:
    enabled: false                           # ä¸å¼ºåˆ¶çŠ¶æ€æ£€æŸ¥
    contexts: []                            # å¯é€‰çš„æ£€æŸ¥é¡¹
      
  # ==================
  # åˆå¹¶è®¾ç½®
  # ==================
  require_linear_history: false             # ä¸è¦æ±‚çº¿æ€§å†å²
  allow_squash_merge: true                  # å…è®¸æ‰€æœ‰åˆå¹¶æ–¹å¼
  allow_merge_commit: true                  
  allow_rebase_merge: true                  
  allow_auto_merge: false                   # ä¸å…è®¸è‡ªåŠ¨åˆå¹¶
  delete_branch_on_merge: true              # åˆå¹¶åè‡ªåŠ¨åˆ é™¤
  
  # ==================
  # æ¨é€é™åˆ¶ï¼ˆå¼€æ”¾ï¼‰
  # ==================
  restrict_pushes:
    enabled: false                          # ä¸é™åˆ¶æ¨é€
    
  # ==================
  # å…¶ä»–ä¿æŠ¤
  # ==================
  allow_force_pushes: true                  # å…è®¸å¼ºåˆ¶æ¨é€ï¼ˆå¼€å‘åˆ†æ”¯ï¼‰
  allow_deletions: true                     # å…è®¸åˆ é™¤åˆ†æ”¯
  lock_branch: false                        
  require_conversation_resolution: false    
  require_deployments: false                

# ==================
# åˆ†æ”¯ç®¡ç†è§„åˆ™
# ==================
branch_management:
  # å‘½åè§„èŒƒ
  naming_convention:
    pattern: "^(feature|fix|docs|chore|refactor|test|style|perf)/[a-z0-9-]+$"
    examples:
      - "feature/user-login"
      - "fix/memory-leak"
      - "docs/api-guide"
      - "chore/update-deps"
    error_message: |
      åˆ†æ”¯åä¸ç¬¦åˆè§„èŒƒï¼
      è¯·ä½¿ç”¨: {type}/{description}
      å…¶ä¸­ type ä¸º: feature|fix|docs|chore|refactor|test|style|perf
      description ä½¿ç”¨å°å†™å­—æ¯ã€æ•°å­—å’Œè¿å­—ç¬¦
  
  # ç”Ÿå‘½å‘¨æœŸç®¡ç†
  lifecycle:
    max_age_days: 30                        # æœ€é•¿å­˜æ´»æ—¶é—´
    stale_warning_days: 21                  # è¿‡æœŸè­¦å‘Šæ—¶é—´
    auto_close_days: 60                     # è‡ªåŠ¨å…³é—­æ—¶é—´
    
  # åˆå¹¶è§„åˆ™
  merge_rules:
    allowed_targets:                        # å…è®¸åˆå¹¶åˆ°çš„åˆ†æ”¯
      "feature/*": ["develop"]
      "fix/*": ["develop", "main"]          # fix å¯ä»¥åˆå¹¶åˆ° mainï¼ˆhotfixï¼‰
      "docs/*": ["develop", "main"]         # æ–‡æ¡£å¯ä»¥ç›´æ¥åˆ° main
      "chore/*": ["develop"]
      "refactor/*": ["develop"]
      "test/*": ["develop"]
      "style/*": ["develop"]
      "perf/*": ["develop"]
    
    forbidden_targets:                      # ç¦æ­¢åˆå¹¶åˆ°çš„åˆ†æ”¯
      "*": ["feature/*", "fix/*"]           # ä¸èƒ½åˆå¹¶åˆ°å…¶ä»–åŠŸèƒ½åˆ†æ”¯
      
# ==================
# è‡ªåŠ¨åŒ–è§„åˆ™
# ==================
automation:
  # PR åˆ›å»ºæ—¶
  on_pr_created:
    # è‡ªåŠ¨åˆ†é…
    auto_assign:
      enabled: true
      reviewers: 1                          # è‡ªåŠ¨åˆ†é… 1 ä¸ªå®¡æ ¸è€…
      from_team: ["developers"]
      exclude_author: true
      
    # è‡ªåŠ¨æ ‡ç­¾
    auto_label:
      by_branch_name: true                  # æ ¹æ®åˆ†æ”¯åæ·»åŠ æ ‡ç­¾
      by_files_changed: true                # æ ¹æ®æ–‡ä»¶å˜åŒ–æ·»åŠ æ ‡ç­¾
      by_pr_title: true                     # æ ¹æ® PR æ ‡é¢˜æ·»åŠ æ ‡ç­¾
      
    # æ£€æŸ¥åˆ—è¡¨
    checklist:
      enabled: true
      items:
        - "ä»£ç å·²æœ¬åœ°æµ‹è¯•"
        - "æ·»åŠ äº†å¿…è¦çš„æµ‹è¯•"
        - "æ›´æ–°äº†ç›¸å…³æ–‡æ¡£"
        - "éµå¾ªäº†ä»£ç è§„èŒƒ"
        
  # è¿‡æœŸåˆ†æ”¯å¤„ç†
  stale_branch:
    enabled: true
    check_interval: daily
    actions:
      warning:                              # è­¦å‘Šé˜¶æ®µ
        after_days: 21
        comment: "âš ï¸ è¿™ä¸ªåˆ†æ”¯å·²ç» {days} å¤©æ²¡æœ‰æ´»åŠ¨äº†"
        label: "stale"
      close:                                # å…³é—­é˜¶æ®µ
        after_days: 60
        comment: "ğŸ”’ åˆ†æ”¯å› é•¿æœŸä¸æ´»åŠ¨è€Œå…³é—­"
        close_pr: true
        delete_branch: false                # ä¸è‡ªåŠ¨åˆ é™¤ï¼Œæ‰‹åŠ¨ç¡®è®¤
        
  # æ¸…ç†å·²åˆå¹¶åˆ†æ”¯
  cleanup:
    enabled: true
    delete_merged_branches: true
    keep_branches: []                       # ä¿ç•™çš„åˆ†æ”¯æ¨¡å¼
    run_schedule: "0 0 * * 0"              # æ¯å‘¨æ—¥å‡Œæ™¨è¿è¡Œ